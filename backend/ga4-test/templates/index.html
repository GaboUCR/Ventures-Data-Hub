<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>GA4 Test Page</title>

    <!-- GA4 tag -->
    {% if ga_measurement_id and ga_measurement_id != "G-XXXXXXX" %}
      <script async src="https://www.googletagmanager.com/gtag/js?id={{ ga_measurement_id }}"></script>
      <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', '{{ ga_measurement_id }}');
      </script>
    {% else %}
      <!-- No GA4 measurement ID configured -->
      <script>
        console.warn("GA_MEASUREMENT_ID not set; GA4 will not fire.");
      </script>
    {% endif %}
  </head>
  <body>
    <h1>GA4 Test Page</h1>
    <p>If GA4 is set up correctly, this page view should appear in GA4 Realtime / DebugView.</p>

    <button onclick="sendTestEvent()">Send custom test event</button>

    <script>
      function sendTestEvent() {
        if (typeof gtag === "function") {
          gtag('event', 'test_button_click', {
            event_category: 'engagement',
            event_label: 'GA4 test button',
            value: 1
          });
          alert("Test event sent (test_button_click). Check GA4 DebugView / Realtime.");
        } else {
          alert("gtag is not defined. Is GA_MEASUREMENT_ID configured?");
        }
      }
    </script>
  </body>
</html>
